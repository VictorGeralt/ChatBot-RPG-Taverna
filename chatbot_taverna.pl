% Base de conhecimento
% Dialogos
pedir_comida('Você se acomoda na mesa da taverna e o taverneiro diz: "Nosso cardapio é vasto e contem as melhores receitas de todos os cantos de Arton e nossa famosa carne de dragao, veja nossos principais pratos."').
pedir_bebida('Você se acomoda na mesa da taverna e o taverneiro diz: "Nossa carta de bebidas é a com opçoes mais ecleticas de todo continente para poder agradar qualquer um, veja as principais bebidas."').
alugar_quarto('"Aqui no Dragao Vermelho podemos oferecer varios quartos para os aventureiros. Nossos quartos sao extremamente confortaveis e alem da cama em cada um deles tem uma mesa e cadeira tanto para uma refeição privada ou planejar suas proximas açoes. Caso esteja interessado em um quarto estarei disponivel para auxilia-lo e fornecer a chave do quarto."').
evento_taverna('O taverneiro abre um sorriso alegre e diz para voce: "Você nao poderia aparecer em um momento mais emocionante para nos, vou lhe contar sobre os dois grandes eventos que estao prestes a ocorrer aqui. sobre qual voce quer ouvir?"').
info_cidade('"Nossa capital é gigantesca. O que voce gostaria de saber ela?"').
pegar_trabalho('"Entao você passou aqui em busca de trabalho? Otimo, isso acontece sempre e o pessoal da cidade sempre precisa de ajuda. Qual tipo de serviço vc prefere').
% Comidas
comida('batata valkariana.', 'Chega em sua mesa um prato cheio de batatas cortadas em tiras e mergulhadas em oleo fervente. Gordurentas e que não parecem muito nutritivas, são o tipo de prato que só é servido numa metropole como Valkaria. Sirius te diz:"Eles nunca concordam mas das poucas coisas em que as clerigas de Lenae medicos de Salistick chegam em um consenso é que essas batatas trazem diversos maleficios a saude, hahaha. Mesmo assim, esse é um prato que todos pedem. Gostoso e deixa qualquer um empolgado').
comida('bolinhos de jade.', 'Sirius leva ate sua mesa um tabuleiro com varios bolinhos verdes como jade, eles parecem recheados e voce nao sabe do que mas voce tem certeza que tem um otimo cheiro. Ele os coloca em sua mesa com um sorriso e lhe diz: "Essa receita foi ensinada diretamente pelo deus Lin-Wu, com sua personalidade benevolente compromissada com a honra e com a verdade ele abençoa seus seguidores com esses pequenos bolinhos acessiveis e portateis que agradam na mesma medida os nobres em seus banquetes e o mais simples dos camponeses em suas casa. Apos sua terra ser varrida do continente pelo ataque da Tormenta, esse pao macio recheado é colocado sobre nossas mesas."').
comida('macarrao de yuvalin.', 'Uma bacia anormalmente grande é colocada na sua frente fazendo um baque na mesa que você esta. Macarrao com um molho de creme de leite e bastante bacon. Antes de voce começa a comer Sirius diz: "Esse vem direto de Yuvalin uma cidade mineradora em Zakharov, na fronteira com as Montanhas Uivantes. Seus habitantes criaram este prato extremamente energetico para encarar suas arduas jornadas de trabalho nas minas. O melhor de tudo é que tambem é delicioso, então se espalhou por outras cidades e reinos chegando ate sua mesa meu amigo."').
comida('bife de dragao especial.', 'Numa tabua de carne chega um pedaço gigante de carne com alguns legumes junto. Sirius diz com um grande sorriso e orgulho na voz:"Essa é nossa maior especialidade. Um bife raro e suculento, proveniente de um dragão abatido em batalha. Temperado com ervas especiais e grelhado na perfeição especialmente por mim. Espero que aproveite"').
% Bebidas
bebida('cerveja ana.', 'A caneca de vidro gelada é colocada na sua frente com força pelo Sirius e então ele diz: "Outra joia vinda diretamente de Yuvalin. Além de ótimos mineradores, esses anões fazem incríveis cervejas. O maior diferencial é a água cristalina tirada diretamente da mina anã, enriquecida por minerais provenientes das rochas ancestrais das montanhas próximas. Cada gole te leva direto para uma aconchegante casa anã."').
bebida('vinho elfico envelhecido.', 'Uma taça delicada com pequenos entalhes é colocada delicadamente em sua mesa e você escuta: "Prepare-se para uma experiência como nenhuma outra. Esse vinho é envelhecido em barris de carvalho vindos diretamente da floresta dos elfos e produzido com uvas cultivadas nos vinhedos élficos, onde a sabedoria ancestral é aplicada para criar uma bebida ancestral, mostrando ao degustador uma viagem pelos séculos de história e tradição élfica."').
bebida('gorad quente.', 'Uma caneca quente com fumaça saindo dela é colocada em sua mesa e Sirius diz: "Já experimentou Gorad? É um doce característico do continente. Ele é tão bom que vale seu próprio peso em ouro. Vindo diretamente do Protetorado de Roddenphord, esse Gorad que estou lhe servindo é feito com leite, açúcar e frutas. Ele aquece seu corpo e seu coração."').
% Quartos
quarto('quarto da frente.', '"O quarto da frente tem uma ótima vista para toda a cidade e mesmo assim é tranquilo para relaxar. Qualquer cidadão ficaria feliz em passar uma noite nesses aposentos."').
quarto('quarto dos fundos.', '"Um quarto aconchegante e bem reservado. Nem mesmo os gritos e a música daqui podem incomodar quem está tentando se concentrar nesse quarto."').
quarto('quarto de luxo.', 'Com certeza, esse é o melhor quarto de toda a cidade, com seu próprio serviço de quarto e cama feita com a mais pura seda de toda Arton.').
quarto('ir para qualquer quarto dormir.', '"Tudo ótimo, não precisa se preocupar em escolher alguma coisa, aventureiro. Pode deixar que eu resolvo, e com certeza você estará bem acomodado."').
% Eventos da Taverna
evento('campeonato de luta.', '"O tao esperado campeonato de luta do Dragao Vermelho esta para acontecer daqui dois dias. Ele irá atrair competidores de todos os cantos de Arton e espectadores ansiosos para assistir todos confrontos pois sera a melhor oportunidade de ver confrontos epicos"').
evento('apresentacao do bardo.', '"Dee o Bardo Louco estará presente na cidade amanha. Como um seguidor de Nimb o deus do caos é simplesmente impossivel saber onde ele ira aparecer e fazer uma apresentação e ele aparecerá aqui. Estamos todos muito ansiosos, se prepare para se envolver em uma experciencia verdadeiramente memoravel"').
% Informaçoes da cidade
info('a grande estatua.', '"Nossa cidade foi construída em volta de uma gigantesca estátua, como você pode ver. A quilômetros da fronteira já é possível visualizar sua imponência. Aceitou-se que ela representava toda a glória de Valkaria, a deusa da ambição e da conquista, dando esse nome à nossa cidade. Um velho mendigo louco, conhecido por toda a cidade, afirma que a estátua se trata da própria deusa, transformada em pedra por se rebelar contra o resto dos deuses. Essa lenda é contada em todas as tavernas da cidade, hahaha."').
info('bairros famosos.', '"Temos vários bairros na cidade e, em sua maioria, são separados pela raça que lá habita. Temos vários, mas conheço de perto apenas esses. Sobre qual gostaria de saber?"').
info('pontos de interesse.', '"Existem também vários lugares para se visitar. Posso te falar um pouco sobre eles para que você passe lá e faça uma visita."').
info('guildas e organizacoes.', '"Muitas organizações influenciam nessa grande cidade, cada uma com seus objetivos. Te aconselho a não ir contra nenhuma caso valorize sua vida. As três que mais tenho conhecimento são:"').
% Trabalhos
trabalho('caçar monstros.', '"Ok... Nas redondezas da nossa cidade, estão ocorrendo constantes assassinatos e ataques. Relatos recentes nos levam a concluir que algum tipo de monstro tem causado esse alvoroço. Sua tarefa seria eliminá-lo, garantindo a segurança dos moradores da região."').
trabalho('captura de ladroes.', '"Um grupo de ladrões denominados "Sombras Noturnas" tem aterrorizado os moradores da cidade de Valkaria. Seu principal objetivo é obter o máximo de informações possíveis e repassá-las para a guarda. NÃO TENTE RESOLVER SOZINHO. Eles são extremamente perigosos. Leve as informações para as autoridades."').
trabalho('protecao de caravanas.', '"Esse pode ser um trabalho mais simples. Um grupo de mercadores pede proteção para poder viajar pela estrada com segurança. É questão de sorte, meu amigo... Geralmente, nada acontece, mas pode ser que aconteça, hahaha. Boa sorte."').
% Bairros famosos
infobairro('nitamu ra.', '"Também chamada de Pequena Tamu-ra, esse é o bairro mais exótico da cidade. É composto pelos restos dos sobreviventes do desastre causado pela Tormenta. É de lá que vêm os bolinhos de jade servidos na taverna. Mesmo sendo apenas um bairro, Nitamu-ra funciona quase como um reino independente dentro do próprio reinado."').
infobairro('vila elfica.', '"Após a destruição de Lenórienn, os elfos se espalharam por todos os lugares possíveis. Esta vila é o maior aglomerado de elfos conhecido, contando com mais de três mil elfos. Temos essa comunidade exótica na cidade."').
infobairro('favela goblin.', '"Com certeza é o lugar mais sujo da cidade. Evitado por todas as raças, esse lugar contém apenas goblins. Por enxergarem no escuro, esse local não tem nenhum tipo de iluminação, e todas as casas são minúsculas, feitas de blocos de pedras empilhadas como iglus. Geralmente, servem de fachadas para uma toca subterrânea maior. Dizem que a maior parte da favela é um conglomerado de túneis subterrâneos complexos que levam até um templo subterrâneo de uma deusa não permitida na cidade."').
%Pontos de interesse
infoponto('academia arcana.', '"É a maior escola de magia de todo o multiverso e uma das maiores maravilhas do mundo de Arton. Foi construída em um semiplano concedido pela própria deusa Wynna a Talude, o arquimago e reitor do local. Estudar lá é o sonho de qualquer um que almeja seguir o caminho arcano."').
infoponto('arena imperial.', '"A Arena Imperial é o maior anfiteatro dedicado a espetáculos grandiosos, localizado no centro da cidade. São realizados espetáculos semanais que vão desde corridas de bigas, apresentações de bardos, torneios mágicos (supervisionados pela Academia Arcana) e combates simulados e reais entre todo tipo de seres."').
infoponto('templo escondido.', 'Como você sabe, a deusa principal dessa cidade é Valkaria, mas isso nos leva a outro ponto... Tenebra é uma deusa inimiga. Pelos boatos, os goblins no fundo de seu complexo sistema subterrâneo construíram uma igreja inteira para Tenebra, a Mãe da Noite.').
%Guildas e organizaçoes
infogeo('guilda dos gladiadores.', 'É o local onde os empresários de gladiadores da Arena Imperial se encontram para discutir como ganhar mais tibares com o uso do anfiteatro e contratarem mais lutadores. Tome cuidado com eles, pois são todos desalmados e corrompidos pela ganância.').
infogeo('igreja de valkaria.', 'A igreja de Valkaria é dedicada à grande deusa representada pela gigantesca estátua na cidade. Há muito tempo, seus clérigos só conseguiam manifestar seus poderes até as fronteiras do reino de Deheon. Apesar da capital ser um local atraente para a igreja de Valkaria, sua religião está gradualmente perdendo seguidores, que estão se convertendo para o culto de Khalmyr.').
infogeo('protetorado do reino.', 'O Protetorado é um grupo de aventureiros oficiais da coroa de Deheon. Suas missões são consideradas suicidas por muitas pessoas. Cansado dos mercenários pouco confiáveis e dos constantes ataques de monstros contra seus guardas, o rei Philydio, "o Tranquilo", decidiu criar um grupo de agentes especiais altamente treinados com o objetivo de proteger os interesses da coroa. Atualmente, sua base está no Palácio Imperial e eles estão sempre em busca de grandes guerreiros para se juntarem a eles.').

% Predicado para iniciar o chatbot "chatbot."
chatbot :-
    entrar_taverna,
	menu.

entrar_taverna :-
    format('Ao cair da noite voce começa a se aproximar de uma grande porta de madeira, quanto mais perto 
    você chega mais alto voce escuta o som de pessoas conversando, rindo alto e musicas sendo cantadas e tocadas.'),nl,
    format('Entrando na taverna voce é recebido por um aroma delicioso de bebida e as risadas te acalmam 
    apos as lutas que voce participou. Atras de um balcao de madeira de carvalho, um homem com aparencia jovem sorri para você.'),nl,
    format('"Meu nome é Sirius, seja bem vindo aventureiro, a maior taverna da cidade de Valkaria a Taverna do Dragao Vermelho. 
    Aqui voce encontrará conforto e boa comida e companhia"'),nl.

menu :-
    nl,format('O que voce deseja?'),nl,
    format('\t1 - Pedir Comida'),nl,
    format('\t2 - Pedir Bebida'),nl,
    format('\t3 - Alugar um quarto'),nl,
    format('\t4 - Eventos da Taverna'),nl,
    format('\t5 - Informaçoes da cidade'),nl,
    format('\t6 - Pegar um trabalho'),nl,
    format('\t7 - Sair pela porta'),nl,
    format('\t8 - Ir para o quarto'),nl,
    format('-> '),
    read(Input),
    process_menu(Input),
	menu.

    process_menu(1):-
    skip_line,
    pedir_comida.

    process_menu(2):-
    skip_line,
    pedir_bebida.
    
    process_menu(3):-
    skip_line,
    alugar_quarto.
    
    process_menu(4):-
    skip_line,
    evento_taverna.
    
    process_menu(5):-
    skip_line,
    info_cidade.
    
    process_menu(6):-
    skip_line,
    pegar_trabalho.
	
    process_menu(7):-
    sairF.
	
    process_menu(8):-
    sairQ.

pedir_comida :-
    nl,format(' '),nl,
    pedir_comida(Texto),
    write(Texto),
    format(' '),nl,
 	format('- Batata Valkariana.'),nl,
    format('- Bolinhos de Jade.'),nl,
    format('- Macarrao de Yuvalin.'),nl,
    format('- Bife de Dragao Especial.'),nl,
    format('-> '),
    ler_string_com_espaco(Comida),
    downcase_atom(Comida, ComidaLowerCase),
    processar_comida(ComidaLowerCase).

pedir_bebida :-
    nl,format(' '),nl,
    pedir_bebida(Texto),
    write(Texto),
    format(' '),nl,
 	format('- Cerveja Ana.'),nl,
    format('- Vinho Elfico Envelhecido.'),nl,
    format('- Gorad Quente.'),nl,
    format('-> '),
    ler_string_com_espaco(Bebida),
    downcase_atom(Bebida, BebidaLowerCase),
    processar_bebida(BebidaLowerCase).

alugar_quarto :-
    nl,format(' '),nl,
    alugar_quarto(Texto),
    write(Texto),
    format(' '),nl,
    format('Os diponiveis atualmente sao:'),nl,
 	format('- Quarto da frente.'),nl,
    format('- Quarto dos fundos.'),nl,
    format('- Quarto de luxo.'),nl,
    format('- Ir para um quarto qualquer dormir.'),nl,
    format('-> '),
    ler_string_com_espaco(Quarto),
    downcase_atom(Quarto, QuartoLowerCase),
    processar_quarto(QuartoLowerCase).
    

evento_taverna :-
    nl,format(' '),nl,
    evento_taverna(Texto),
    write(Texto),
    format(' '),nl,
 	format('- Campeonato de Luta.'),nl,
    format('- Apresentacao do Bardo.'),nl,
    format('-> '),
    ler_string_com_espaco(Evento),
    downcase_atom(Evento, EventoLowerCase),
    processar_evento(EventoLowerCase).

info_cidade :-
    nl,format(' '),nl,
    info_cidade(Texto),
    write(Texto),
    format(' '),nl,
 	format('- A grande estatua.'),nl,
    format('- Bairros Famosos.'),nl,
    format('- Pontos de interesses.'),nl,
    format('- Guildas e organizacoes.'),nl,
    format('-> '),
    ler_string_com_espaco(Info),
    downcase_atom(Info, InfoLowerCase),
    processar_infocity(InfoLowerCase).

pegar_trabalho :-
    nl,format(' '),nl,
    pegar_trabalho(Texto),
    write(Texto),
    format(' '),nl,
 	format('- Cacar monstros.'),nl,
    format('- Captura de Ladroes.'),nl,
    format('- Protecao de caravanas.'),nl,
    format('-> '),
    ler_string_com_espaco(Trabalho),
    downcase_atom(Trabalho, TrabalhoLowerCase),
    processar_trabalho(TrabalhoLowerCase).

sairF :-
    format('"Adeus aventureiro, boa sorte em sua jornada!"'),
    halt.
    
sairQ :-
    format('"Bom descanso aventureiro, tenha uma otima noite de sono!"'),
    halt.

processar_comida(ComidaLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    comida(ComidaLowerCase, Desc),
    write('Você escolheu '), write(ComidaLowerCase), nl,
    format(' '),nl,
    write(Desc),
    format(' '),nl,
    format(' '),nl,
    write('Deseja escolher outro prato? (sim/nao)'), nl,
    read(Escolha),
    processar_escolha_comida(Escolha).

processar_comida(_) :-
    write('Prato invalido. Por favor, escolha novamente.'), nl,
	pedir_comida.

processar_escolha_comida(sim) :-
    skip_line,
    pedir_comida.

processar_escolha_comida(nao) :-
    menu.

processar_bebida(BebidaLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    bebida(BebidaLowerCase, Desc),
    write('Você escolheu '), write(BebidaLowerCase), nl,
    format(' '),nl,
    write(Desc),
    format(' '),nl,
    format(' '),nl,
    write('Deseja escolher outra bebida? (sim/nao)'), nl,
    read(Escolha),
    processar_escolha_bebida(Escolha).

processar_bebida(_) :-
    write('Bebida invalida. Por favor, escolha novamente.'), nl,
	pedir_bebida.

processar_escolha_bebida(sim) :-
    pedir_bebida.

processar_escolha_bebida(nao) :-
    menu.


processar_quarto('ir para um quarto qualquer dormir.') :-
    sairQ.


processar_quarto(QuartoLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    quarto(QuartoLowerCase, Desc),
    write('Você escolheu '), write(QuartoLowerCase), nl,
    format(' '),nl,
    write(Desc),
    format(' '),nl,
    format(' '),nl,
    write('"Aqui esta a chave. Fique a vontade"'), nl,
    menu.

processar_quarto(_) :-
    write('Quarto invlido. Por favor, escolha novamente.'), nl,
    skip_line,
	alugar_quarto.


processar_evento(EventoLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    evento(EventoLowerCase, Desc),
    write('Você escolheu '), write(EventoLowerCase), nl,
    format(' '),nl,
    write(Desc),
    format(' '),nl,
    format(' '),nl,
    write('"Quer ouvir mais sobre algo relacionado a eventos?" (sim/nao)'), nl,
    read(Escolha),
    processar_escolha_evento(Escolha).

processar_evento(_) :-
    write('Evento invalido. Por favor, escolha novamente.'), nl,
    skip_line,
	evento_taverna.

processar_escolha_evento(sim) :-
    skip_line,
    evento_taverna.

processar_escolha_evento(nao) :-
    skip_line,
    menu.

processar_infocity(InfoLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    info(InfoLowerCase, Desc),
    write('Você escolheu '), write(InfoLowerCase), nl,
    format(' '),nl,
    write(Desc),
    processar_escolha_infocity(InfoLowerCase),
    format(' '),nl,
    write('"Quer ouvir mais sobre alguma informaçao relacionada a cidade?" (sim/nao)'), nl,
    read(Escolha),
    processar_escolha_infocitymore(Escolha).

processar_infocity(_) :-
    write('Informaçao invalida. Por favor, escolha novamente.'), nl,
    skip_line,
	info_cidade.

processar_escolha_infocity('a grande estatua.') :-
    write(''),
    skip_line,
    info_cidade.

processar_escolha_infocity('bairros famosos.') :-
    nl,format(' '),nl,
    write('Bairros Famosos:'),
    format(' '),nl,
 	format('- Nitamu ra.'),nl,
    format('- Vila Elfica.'),nl,
    format('- Favela Goblin.'),nl,
    format('-> '),
    ler_string_com_espaco(Infobairro),
    downcase_atom(Infobairro, InfobairroLowerCase),
    processar_infocity_infobairro(InfobairroLowerCase).

processar_escolha_infocity('pontos de interesses.') :-
    nl,format(' '),nl,
    write('Pontos de Interesses:'),
    format(' '),nl,
 	format('- Academia Arcana.'),nl,
    format('- Arena Imperial.'),nl,
    format('- Templo Escondido.'),nl,
    format('-> '),
    ler_string_com_espaco(Infopontosint),
    downcase_atom(Infopontosint, InfopontosintLowerCase),
    processar_infocity_infopontosint(InfopontosintLowerCase).

processar_escolha_infocity('guildas e organizacoes.') :-
    nl,format(' '),nl,
    write('Guildas e Organizacoes:'),
    format(' '),nl,
 	format('- Guilda dos Gladiadores.'),nl,
    format('- Igreja de Valkaria.'),nl,
    format('- Protetorado do Reino.'),nl,
    format('-> '),
    ler_string_com_espaco(Infogeo),
    downcase_atom(Infogeo, InfogeoLowerCase),
    processar_infocity_Infogeo(InfogeoLowerCase).

processar_infocity_infobairro(InfobairroLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    infobairro(InfobairroLowerCase, Desc),
    write('Você escolheu '), write(InfobairroLowerCase), nl,
    format(' '),nl,
    write(Desc),
    format(' '),nl.

processar_infocity_infobairro(_) :-
    write('Bairro invalido.'),
    skip_line,
	format(' '),nl.


processar_infocity_infopontosint(InfopontosintLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    infoponto(InfopontosintLowerCase, Desc),
    write('Você escolheu '), write(InfopontosintLowerCase), nl,
    format(' '),nl,
    write(Desc),
    format(' '),nl.

processar_infocity_infopontosint(_) :-
    write('Ponto de interesse invalido.'),
    skip_line,
	format(' '),nl.


processar_infocity_Infogeo(InfogeoLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    infogeo(InfogeoLowerCase, Desc),
    write('Você escolheu '), write(InfogeoLowerCase), nl,
    format(' '),nl,
    write(Desc),
    format(' '),nl.

processar_infocity_Infogeo(_) :-
    write('Guilda e/ou organizaçao invalida.'),
    skip_line,
	format(' '),nl.

processar_escolha_infocitymore(sim) :-
    skip_line,
    info_cidade.

processar_escolha_infocitymore(nao) :-
    skip_line,
    menu.

processar_trabalho(TrabalhoLowerCase) :-
    nl,format(' '),
    format(' '),nl,
    trabalho(TrabalhoLowerCase, Desc),
    write('Voce escolheu '), write(TrabalhoLowerCase), nl,
     format(' '),nl,
    write(Desc),
    format(' '),nl,
    format(' '),nl,
    write('"Caso queira aceitar esse trabalho me procure amanha cedo que lhe passarei mais detalhes"'), nl,
    menu.

processar_trabalho(_) :-
    write('Trabalho invalido. Por favor, escolha novamente.'), nl,
    skip_line,
	pegar_trabalho.

ler_string_com_espaco(Variavel) :-
    read_line_to_codes(user_input, Codes),
    string_codes(Variavel, Codes).
